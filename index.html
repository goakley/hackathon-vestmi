<!doctype html>
<html>
  <head>
    <title>Vest.Mi</title>
    <script>
      navigator.getUserMedia = ( navigator.getUesrMedia ||
                                 navigator.webkitGetUserMedia ||
                                 navigator.mozGetUserMedia ||
                                 navigator.msGetUserMedia );
    </script>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <h1>Vest.Mi</h1>
    <p>A sweater vest generator for all your profile pictures!  Keeps your profile picture warm and stylish.&#153;</p>
    <div id="sources">
      <ul id="sources_list">
        <li><div id="fb-root"></div><button id="button_facebook" disabled>Facebook</button></li>
        <li><button id="button_camera" disabled>Camera/Webcam</button></li>
      </ul>
    </div>
    <canvas id="image_source" width=0 height=0></canvas>
    <canvas id="image_sweater" width=0 height=0></canvas>
    <button id="button_regen" disabled>Generate a new sweater!</button>
    <button id="button_publish" disabled>Publish your sweater to Facebook!</button>
    <button id="button_makeprofile" disabled>Make this sweater your profile pic!</button>
    <input id="minecraft_name" type="text" placeholder="Minecraft Name" style="display:none;" />
    <canvas id="image_minecraft" width=64 height=32></canvas>
    <script>
      window.fbAsyncInit = function() {
          FB.init({
              appId      : '1452968264934419',
              status     : true,
              cookie     : true,
              xfbml      : true
          });
          FB.getLoginStatus(fbhandler);
          FB.Event.subscribe('auth.authResponseChange', fbhandler);
          function fbhandler(response) {
              if (response.status === 'connected') {
                  var button = document.getElementById("button_facebook");
                  button.removeChild(button.firstChild);
                  button.appendChild(document.createTextNode("Take Facebook profile picture"));
                  buttons.enable("facebook");
              } else if (response.status === 'not_authorized') {
                  // logged in, unauthorized with app
                  FB.login(function(){}, {scope:'email,user_photos,publish_actions'});
              } else {
                  // not logged in
                  FB.login(function(){}, {scope:'email,user_photos,publish_actions'});
              }
          }
      };
      // Load the SDK asynchronously
      (function(d){
          var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
          if (d.getElementById(id)) {return;}
          js = d.createElement('script'); js.id = id; js.async = true;
          js.src = "//connect.facebook.net/en_US/all.js";
          ref.parentNode.insertBefore(js, ref);
      }(document));
    </script>
    <!--<script src="needles.js"></script>-->
    <script src="knitter.js"></script>
  </body>
</html>
